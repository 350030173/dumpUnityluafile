

//
//get_self_process_name()获取当前运行进程包名
//参考：https://github.com/lasting-yang/frida_dump/blob/master/dump_dex_class.js
function get_self_process_name()
{
    var openPtr = Module.getExportByName('libc.so', 'open');
    var open = new NativeFunction(openPtr, 'int', ['pointer', 'int']);

    var readPtr = Module.getExportByName("libc.so", "read");
    var read = new NativeFunction(readPtr, "int", ["int", "pointer", "int"]);

    var closePtr = Module.getExportByName('libc.so', 'close');
    var close = new NativeFunction(closePtr, 'int', ['int']);

    var path = Memory.allocUtf8String("/proc/self/cmdline");
    var fd = open(path, 0);
    if (fd != -1)
    {
        var buffer = Memory.alloc(0x1000);
        var result = read(fd, buffer, 0x1000);
        close(fd);
        result = ptr(buffer).readCString();
        return result;
    }

    return "-1";
}



function hook_dlopen()
{
    var is_can_hook = false;
    Interceptor.attach(Module.findExportByName(null, "dlopen"),
        {
            onEnter: function (args)
            {
                var pathptr = args[0];
                if (pathptr !== undefined && pathptr != null)
                {
                    var path = ptr(pathptr).readCString();
                    //console.log("dlopen:", path);
                    if (path.indexOf(soName) >= 0)
                    {
                        this.is_can_hook = true;
                        console.log("\n" + soName + "_path:", path);

                    }
                }
            },
            onLeave: function (retval)
            {
                if (this.is_can_hook)
                {
                    dumpUnityLua();
                    console.log("dlopen finish...");
                }
            }
        }
    );

    Interceptor.attach(Module.findExportByName(null, "android_dlopen_ext"),
        {
            onEnter: function (args)
            {
                var pathptr = args[0];
                if (pathptr !== undefined && pathptr != null)
                {
                    var path = ptr(pathptr).readCString();
                    //console.log("android_dlopen_ext:", path);

                    if (path.indexOf(soName) >= 0)
                    {
                        this.is_can_hook = true;
                        console.log("\n" + soName + "_path:", path);
                    }
                }
            },
            onLeave: function (retval)
            {
                if (this.is_can_hook)
                {
                    dumpUnityLua();
                    console.log("android_dlopen_ext  finish...");
                }
            }
        }
    );
}


/**

unity中hook的函数
// Namespace: LuaInterface
public class LuaDLL // TypeDefIndex: 5749
public static int luaL_loadbuffer(IntPtr luaState, byte[] buff, int size, string name); // 0x127E5DC

*/

//写入 lua 文件
function modifyUnityLua()
{
    Java.perform(function ()
    {
        console.log("modifyUnityLua...");

        var moduleBaseAddress = Module.getBaseAddress("libil2cpp.so");
        var nativePointer = moduleBaseAddress.add(0x127E5DC);
        console.log("==nativePointer", nativePointer);
        Interceptor.attach(nativePointer,
            {
                onEnter: function (args)
                {
                    var size = args[2].add(is32).toInt32();
                    var name = args[3].add(is32).readUtf16String();
                    console.log("fileSize: " + size);
                    console.log("fileName: " + name);
                    if (name.indexOf("PlayerDataManager") >= 0)
                    {
                        //打印出想改的文件的字节码，打印出来后，复制到 icyberchef ,转换为16进制码，
                        //再保存到010，再修改，注意字节码长度要一样，增加或删掉的字节码会导致文件长度不一样
                        //可以利用里面的注释补齐字节码
                        /*console.log(hexdump(args[1].add(0x10),
                           {
                               offset: 0,
                               length: size,
                               header: true,
                               ansi: true
                           }
                       )); */
                        //需要保证写入的文件和原文件的长度必须一致，否则可能出错
                        //也就是 参数中的size ，和写入的 mybuff 长度必须一致
                        Memory.writeByteArray(args[1].add(0x10), mybuff);
                    }

                },
                onLeave: function (retval)
                {

                }
            }
        );
    }
    );
}

//dump lua 文件
function dumpUnityLua()
{
    Java.perform(function ()
    {
        console.log("dumpUnityLua...");

        var moduleBaseAddress = Module.getBaseAddress("libil2cpp.so");
        var nativePointer = moduleBaseAddress.add(0x127E5DC);
        console.log("==nativePointer", nativePointer);
        Interceptor.attach(nativePointer,
            {
                onEnter: function (args)
                {
                    var size = args[2].add(is32).toInt32();//如果游戏是64位的，这里可能要加0x10
                    var name = args[3].add(is32).readUtf16String();//如果游戏是64位的，这里可能要加0x10
                    console.log("size: " + size);
                    console.log("name: " + name);
                    if (name.indexOf("/") >= 0)
                    {
                        name = name.replace(/\//g, "_");//文件名带有正斜杠，替换为下划线
                    }
                    var file = new File("/sdcard/Android/data/" + get_self_process_name() + "/files/" + name, "wb");
                    file.write(Memory.readByteArray(args[1].add(0xc), size));
                    file.flush();
                    file.close();
                },
                onLeave: function (retval)
                {

                }
            }
        );
    }
    );
}

var soName = "libil2cpp.so"

//重新写入的文件流
//重新写入的文件
var mybuff = [45, 45, 91, 91, 10, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 58, 32, 10, 65, 117, 116, 104, 111, 114, 58, 32, 108, 105, 106, 105, 97, 110, 103, 10, 68, 97, 116, 101, 58, 32, 50, 48, 50, 49, 45, 48, 56, 45, 50, 48, 32, 49, 49, 58, 51, 53, 58, 49, 57, 10, 85, 110, 105, 116, 121, 86, 101, 114, 115, 105, 111, 110, 58, 32, 85, 110, 105, 116, 121, 32, 50, 48, 49, 56, 46, 49, 56, 46, 51, 46, 49, 52, 102, 49, 10, 86, 101, 114, 115, 105, 111, 110, 58, 32, 118, 32, 49, 46, 48, 10, 70, 105, 108, 101, 80, 97, 116, 104, 58, 32, 47, 99, 108, 105, 101, 110, 116, 47, 65, 115, 115, 101, 116, 115, 47, 76, 117, 97, 70, 114, 97, 109, 101, 119, 111, 114, 107, 47, 76, 117, 97, 47, 76, 111, 103, 105, 99, 47, 67, 117, 115, 116, 111, 109, 47, 66, 117, 105, 108, 100, 69, 120, 112, 108, 111, 114, 101, 47, 77, 97, 110, 97, 103, 101, 114, 47, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 108, 117, 97, 10, 68, 101, 115, 99, 114, 105, 112, 116, 105, 111, 110, 58, 32, 231, 142, 169, 229, 174, 182, 230, 149, 176, 230, 141, 174, 231, 174, 161, 231, 144, 134, 231, 177, 187, 10, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 58, 32, 10, 45, 45, 93, 93, 10, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 32, 61, 32, 123, 125, 10, 10, 108, 111, 99, 97, 108, 32, 116, 104, 105, 115, 32, 61, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 10, 116, 104, 105, 115, 46, 117, 115, 101, 114, 73, 100, 32, 61, 32, 110, 105, 108, 10, 116, 104, 105, 115, 46, 116, 111, 107, 101, 110, 32, 61, 32, 110, 105, 108, 10, 116, 104, 105, 115, 46, 115, 99, 101, 110, 101, 73, 100, 32, 61, 32, 110, 105, 108, 10, 116, 104, 105, 115, 46, 105, 115, 73, 110, 105, 116, 32, 61, 32, 102, 97, 108, 115, 101, 10, 116, 104, 105, 115, 46, 115, 111, 99, 105, 97, 108, 73, 100, 32, 61, 32, 110, 105, 108, 32, 32, 32, 32, 32, 32, 32, 32, 32, 45, 45, 231, 164, 190, 228, 186, 164, 105, 100, 10, 116, 104, 105, 115, 46, 118, 105, 115, 105, 116, 111, 114, 32, 61, 32, 123, 125, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 45, 45, 230, 184, 184, 229, 174, 162, 230, 149, 176, 230, 141, 174, 10, 116, 104, 105, 115, 46, 115, 111, 99, 105, 97, 108, 32, 61, 32, 123, 125, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 45, 45, 231, 164, 190, 228, 186, 164, 230, 149, 176, 230, 141, 174, 10, 116, 104, 105, 115, 46, 107, 105, 116, 73, 100, 32, 61, 32, 45, 49, 10, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 73, 110, 105, 116, 40, 41, 10, 32, 32, 32, 32, 116, 104, 105, 115, 46, 105, 115, 73, 110, 105, 116, 32, 61, 32, 116, 114, 117, 101, 10, 32, 32, 32, 32, 116, 104, 105, 115, 46, 73, 110, 105, 116, 76, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 40, 41, 10, 32, 32, 32, 32, 116, 104, 105, 115, 46, 73, 110, 105, 116, 75, 105, 116, 68, 97, 116, 97, 40, 41, 10, 101, 110, 100, 10, 10, 45, 45, 229, 136, 157, 229, 167, 139, 229, 140, 150, 229, 133, 179, 229, 141, 161, 230, 149, 176, 230, 141, 174, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 73, 110, 105, 116, 76, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 40, 41, 10, 32, 32, 32, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 32, 61, 32, 68, 105, 99, 116, 105, 111, 110, 97, 114, 121, 58, 78, 101, 119, 40, 41, 10, 32, 32, 32, 32, 102, 111, 114, 32, 95, 44, 32, 105, 100, 32, 105, 110, 32, 112, 97, 105, 114, 115, 40, 76, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 95, 67, 111, 110, 102, 105, 103, 46, 95, 107, 101, 121, 115, 41, 32, 100, 111, 10, 32, 32, 32, 32, 32, 32, 32, 32, 108, 111, 99, 97, 108, 32, 107, 101, 121, 32, 61, 32, 115, 116, 114, 105, 110, 103, 46, 102, 111, 114, 109, 97, 116, 40, 34, 37, 115, 95, 37, 100, 34, 44, 32, 67, 97, 99, 104, 101, 84, 121, 112, 101, 46, 76, 69, 86, 69, 76, 95, 68, 69, 84, 65, 73, 76, 83, 95, 73, 78, 70, 79, 44, 32, 105, 100, 41, 10, 32, 32, 32, 32, 32, 32, 32, 32, 105, 102, 32, 85, 115, 101, 114, 68, 97, 116, 97, 72, 101, 108, 112, 101, 114, 46, 72, 97, 115, 75, 101, 121, 40, 107, 101, 121, 41, 32, 116, 104, 101, 110, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 108, 111, 99, 97, 108, 32, 99, 97, 99, 104, 101, 68, 97, 116, 97, 32, 61, 32, 85, 115, 101, 114, 68, 97, 116, 97, 72, 101, 108, 112, 101, 114, 46, 71, 101, 116, 83, 116, 114, 105, 110, 103, 40, 107, 101, 121, 44, 32, 34, 34, 41, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 105, 102, 32, 99, 97, 99, 104, 101, 68, 97, 116, 97, 32, 126, 61, 32, 110, 105, 108, 32, 97, 110, 100, 32, 99, 97, 99, 104, 101, 68, 97, 116, 97, 32, 126, 61, 32, 34, 34, 32, 116, 104, 101, 110, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 99, 97, 99, 104, 101, 68, 97, 116, 97, 32, 61, 32, 99, 106, 115, 111, 110, 46, 100, 101, 99, 111, 100, 101, 40, 99, 97, 99, 104, 101, 68, 97, 116, 97, 41, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 105, 102, 32, 99, 97, 99, 104, 101, 68, 97, 116, 97, 32, 126, 61, 32, 110, 105, 108, 32, 97, 110, 100, 32, 99, 97, 99, 104, 101, 68, 97, 116, 97, 32, 126, 61, 32, 34, 34, 32, 116, 104, 101, 110, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 108, 111, 99, 97, 108, 32, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 32, 61, 32, 76, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 58, 78, 101, 119, 40, 105, 100, 41, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 58, 73, 110, 105, 116, 68, 97, 116, 97, 40, 99, 97, 99, 104, 101, 68, 97, 116, 97, 41, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 58, 65, 100, 100, 40, 105, 100, 44, 32, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 41, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 101, 110, 100, 10, 101, 110, 100, 10, 10, 45, 45, 229, 136, 157, 229, 167, 139, 229, 140, 150, 228, 184, 187, 233, 162, 152, 230, 149, 176, 230, 141, 174, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 73, 110, 105, 116, 75, 105, 116, 68, 97, 116, 97, 40, 41, 10, 32, 32, 32, 32, 108, 111, 99, 97, 108, 32, 105, 115, 65, 108, 108, 70, 105, 110, 105, 115, 104, 32, 61, 32, 116, 114, 117, 101, 10, 32, 32, 32, 32, 116, 104, 105, 115, 46, 107, 105, 116, 73, 100, 32, 61, 32, 45, 49, 10, 32, 32, 32, 32, 102, 111, 114, 32, 95, 44, 32, 105, 100, 32, 105, 110, 32, 112, 97, 105, 114, 115, 40, 75, 105, 116, 95, 67, 111, 110, 102, 105, 103, 115, 46, 95, 107, 101, 121, 115, 41, 32, 100, 111, 10, 32, 32, 32, 32, 32, 32, 32, 32, 105, 102, 32, 116, 104, 105, 115, 46, 107, 105, 116, 73, 100, 32, 126, 61, 32, 45, 49, 32, 116, 104, 101, 110, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 98, 114, 101, 97, 107, 10, 32, 32, 32, 32, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 32, 32, 32, 32, 108, 111, 99, 97, 108, 32, 108, 101, 118, 101, 108, 73, 68, 65, 114, 114, 32, 61, 32, 115, 116, 114, 105, 110, 103, 46, 115, 112, 108, 105, 116, 40, 75, 105, 116, 95, 67, 111, 110, 102, 105, 103, 115, 91, 105, 100, 93, 46, 108, 101, 118, 101, 108, 73, 68, 44, 32, 34, 95, 34, 44, 32, 116, 111, 110, 117, 109, 98, 101, 114, 41, 10, 32, 32, 32, 32, 32, 32, 32, 32, 102, 111, 114, 32, 105, 61, 49, 44, 32, 35, 108, 101, 118, 101, 108, 73, 68, 65, 114, 114, 32, 100, 111, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 105, 102, 32, 110, 111, 116, 32, 116, 104, 105, 115, 46, 71, 101, 116, 76, 101, 118, 101, 108, 73, 115, 70, 105, 110, 105, 115, 104, 40, 108, 101, 118, 101, 108, 73, 68, 65, 114, 114, 91, 105, 93, 41, 32, 116, 104, 101, 110, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 105, 102, 32, 116, 104, 105, 115, 46, 107, 105, 116, 73, 100, 32, 61, 61, 32, 45, 49, 32, 116, 104, 101, 110, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 116, 104, 105, 115, 46, 107, 105, 116, 73, 100, 32, 61, 32, 105, 100, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 105, 115, 65, 108, 108, 70, 105, 110, 105, 115, 104, 32, 61, 32, 102, 97, 108, 115, 101, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 98, 114, 101, 97, 107, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 105, 102, 32, 105, 115, 65, 108, 108, 70, 105, 110, 105, 115, 104, 32, 116, 104, 101, 110, 10, 32, 32, 32, 32, 32, 32, 32, 32, 108, 111, 103, 69, 114, 114, 111, 114, 40, 34, 229, 133, 179, 229, 141, 161, 229, 133, 168, 233, 131, 168, 229, 174, 140, 230, 136, 144, 34, 41, 10, 32, 32, 32, 32, 101, 110, 100, 10, 101, 110, 100, 10, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 71, 101, 116, 77, 97, 120, 75, 105, 116, 73, 100, 40, 41, 10, 32, 32, 32, 32, 114, 101, 116, 117, 114, 110, 32, 75, 105, 116, 95, 67, 111, 110, 102, 105, 103, 115, 91, 35, 75, 105, 116, 95, 67, 111, 110, 102, 105, 103, 115, 46, 95, 107, 101, 121, 115, 93, 46, 105, 100, 10, 101, 110, 100, 10, 10, 45, 45, 232, 174, 190, 231, 189, 174, 228, 184, 187, 233, 162, 152, 32, 105, 100, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 83, 101, 116, 67, 117, 114, 75, 105, 116, 73, 100, 40, 105, 100, 41, 10, 32, 32, 32, 32, 116, 104, 105, 115, 46, 107, 105, 116, 73, 100, 32, 61, 32, 105, 100, 10, 101, 110, 100, 10, 10, 45, 45, 229, 189, 147, 229, 137, 141, 230, 140, 145, 230, 136, 152, 231, 154, 132, 228, 184, 187, 233, 162, 152, 73, 68, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 71, 101, 116, 67, 117, 114, 75, 105, 116, 73, 100, 40, 41, 10, 32, 32, 32, 32, 114, 101, 116, 117, 114, 110, 32, 116, 104, 105, 115, 46, 107, 105, 116, 73, 100, 10, 101, 110, 100, 10, 10, 45, 45, 229, 133, 179, 229, 141, 161, 230, 152, 175, 229, 144, 166, 229, 174, 140, 230, 136, 144, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 71, 101, 116, 76, 101, 118, 101, 108, 73, 115, 70, 105, 110, 105, 115, 104, 40, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 41, 10, 32, 32, 32, 32, 105, 102, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 58, 67, 111, 110, 116, 97, 105, 110, 115, 75, 101, 121, 40, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 41, 32, 116, 104, 101, 110, 10, 32, 32, 32, 32, 32, 32, 32, 32, 114, 101, 116, 117, 114, 110, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 91, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 93, 58, 71, 101, 116, 73, 115, 70, 105, 110, 105, 115, 104, 40, 41, 10, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 114, 101, 116, 117, 114, 110, 32, 102, 97, 108, 115, 101, 10, 101, 110, 100, 10, 10, 45, 45, 232, 174, 190, 231, 189, 174, 229, 133, 179, 229, 141, 161, 229, 174, 140, 230, 136, 144, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 83, 101, 116, 76, 101, 118, 101, 108, 70, 105, 110, 105, 115, 104, 40, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 41, 10, 32, 32, 32, 32, 116, 104, 105, 115, 46, 67, 114, 101, 97, 116, 101, 76, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 40, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 41, 10, 32, 32, 32, 32, 105, 102, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 58, 67, 111, 110, 116, 97, 105, 110, 115, 75, 101, 121, 40, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 41, 32, 116, 104, 101, 110, 10, 32, 32, 32, 32, 32, 32, 32, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 91, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 93, 58, 83, 101, 116, 70, 105, 110, 105, 115, 104, 40, 116, 114, 117, 101, 41, 10, 32, 32, 32, 32, 32, 32, 32, 32, 69, 118, 101, 110, 116, 77, 97, 110, 97, 103, 101, 114, 46, 66, 114, 111, 99, 97, 115, 116, 40, 69, 118, 101, 110, 116, 84, 121, 112, 101, 46, 70, 73, 78, 73, 83, 72, 95, 77, 79, 68, 69, 76, 44, 32, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 41, 10, 32, 32, 32, 32, 101, 110, 100, 10, 101, 110, 100, 10, 10, 45, 45, 230, 150, 176, 229, 187, 186, 229, 133, 179, 229, 141, 161, 232, 175, 166, 230, 131, 133, 230, 149, 176, 230, 141, 174, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 67, 114, 101, 97, 116, 101, 76, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 40, 108, 101, 118, 101, 108, 73, 100, 41, 10, 32, 32, 32, 32, 105, 102, 32, 110, 111, 116, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 58, 67, 111, 110, 116, 97, 105, 110, 115, 75, 101, 121, 40, 108, 101, 118, 101, 108, 73, 100, 41, 32, 116, 104, 101, 110, 10, 32, 32, 32, 32, 32, 32, 32, 32, 108, 111, 99, 97, 108, 32, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 32, 61, 32, 76, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 58, 78, 101, 119, 40, 108, 101, 118, 101, 108, 73, 100, 41, 10, 32, 32, 32, 32, 32, 32, 32, 32, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 58, 83, 97, 118, 101, 40, 41, 10, 32, 32, 32, 32, 32, 32, 32, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 58, 65, 100, 100, 40, 108, 101, 118, 101, 108, 73, 100, 44, 32, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 41, 10, 32, 32, 32, 32, 101, 110, 100, 10, 101, 110, 100, 10, 10, 45, 45, 232, 174, 190, 231, 189, 174, 229, 133, 179, 229, 141, 161, 230, 152, 159, 230, 149, 176, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 83, 101, 116, 76, 101, 118, 101, 108, 83, 116, 97, 114, 40, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 44, 118, 97, 108, 117, 101, 41, 10, 32, 32, 32, 32, 105, 102, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 58, 67, 111, 110, 116, 97, 105, 110, 115, 75, 101, 121, 40, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 41, 32, 116, 104, 101, 110, 10, 32, 32, 32, 32, 32, 32, 32, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 91, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 93, 58, 83, 101, 116, 83, 116, 97, 114, 40, 118, 97, 108, 117, 101, 41, 10, 32, 32, 32, 32, 101, 110, 100, 10, 101, 110, 100, 10, 10, 45, 45, 232, 142, 232, 232, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 183, 229, 190, 151, 229, 133, 179, 229, 141, 229, 190, 151, 232, 232, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 183, 229, 232, 232, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 232, 232, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 151, 229, 133, 179, 229, 141, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 232, 232, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 232, 232, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 183, 229, 190, 232, 232, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 183, 229, 190, 232, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 183, 229, 190, 151, 232, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 183, 229, 190, 232, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 183, 229, 190, 151, 141, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 229, 133, 179, 229, 141, 183, 229, 190, 151, 229, 133, 179, 229, 141, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 133, 179, 229, 141, 161, 230, 152, 159, 230, 149, 176, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 71, 101, 116, 76, 101, 118, 101, 108, 83, 116, 97, 114, 40, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 41, 10, 32, 32, 32, 32, 114, 101, 116, 117, 114, 110, 32, 49, 48, 48, 10, 101, 110, 100, 10, 10, 45, 45, 232, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 161, 98, 101, 115, 116, 230, 152, 159, 230, 149, 176, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 71, 101, 116, 76, 101, 118, 101, 108, 66, 101, 115, 116, 83, 116, 97, 114, 40, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 41, 10, 32, 32, 32, 32, 114, 101, 116, 117, 114, 110, 32, 49, 48, 48, 10, 101, 110, 100, 10, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 65, 100, 100, 80, 117, 122, 122, 108, 101, 67, 111, 117, 110, 116, 40, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 41, 10, 32, 32, 32, 32, 105, 102, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 58, 67, 111, 110, 116, 97, 105, 110, 115, 75, 101, 121, 40, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 41, 32, 116, 104, 101, 110, 10, 32, 32, 32, 32, 32, 32, 32, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 91, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 93, 58, 65, 100, 100, 80, 117, 122, 122, 108, 101, 67, 111, 117, 110, 116, 40, 118, 97, 108, 117, 101, 41, 10, 32, 32, 32, 32, 101, 110, 100, 10, 101, 110, 100, 10, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 71, 101, 116, 80, 117, 122, 122, 108, 101, 67, 111, 117, 110, 116, 40, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 41, 10, 32, 32, 32, 32, 105, 102, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 58, 67, 111, 110, 116, 97, 105, 110, 115, 75, 101, 121, 40, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 41, 32, 116, 104, 101, 110, 10, 32, 32, 32, 32, 32, 32, 32, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 91, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 73, 100, 93, 58, 71, 101, 116, 80, 117, 122, 122, 108, 101, 67, 111, 117, 110, 116, 40, 118, 97, 108, 117, 101, 41, 10, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 114, 101, 116, 117, 114, 110, 32, 48, 10, 101, 110, 100, 10, 10, 45, 45, 232, 142, 183, 229, 190, 151, 228, 184, 187, 233, 162, 152, 230, 152, 159, 230, 149, 176, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 71, 101, 116, 75, 105, 116, 83, 116, 97, 114, 66, 121, 73, 100, 40, 107, 105, 116, 73, 100, 41, 10, 32, 32, 32, 32, 108, 111, 99, 97, 108, 32, 115, 116, 97, 114, 32, 61, 32, 48, 10, 32, 32, 32, 32, 108, 111, 99, 97, 108, 32, 107, 105, 116, 67, 111, 110, 102, 105, 103, 32, 61, 32, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 71, 101, 116, 75, 105, 116, 67, 111, 110, 102, 105, 103, 66, 121, 73, 100, 40, 107, 105, 116, 73, 100, 41, 10, 32, 32, 32, 32, 108, 111, 99, 97, 108, 32, 108, 101, 118, 101, 108, 73, 100, 115, 32, 61, 32, 115, 116, 114, 105, 110, 103, 46, 115, 112, 108, 105, 116, 40, 107, 105, 116, 67, 111, 110, 102, 105, 103, 46, 108, 101, 118, 101, 108, 73, 68, 44, 32, 34, 95, 34, 44, 32, 116, 111, 110, 117, 109, 98, 101, 114, 41, 10, 32, 32, 32, 32, 102, 111, 114, 32, 105, 61, 49, 44, 32, 35, 108, 101, 118, 101, 108, 73, 100, 115, 32, 100, 111, 10, 32, 32, 32, 32, 32, 32, 32, 32, 115, 116, 97, 114, 32, 61, 32, 115, 116, 97, 114, 32, 43, 32, 116, 104, 105, 115, 46, 71, 101, 116, 76, 101, 118, 101, 108, 66, 101, 115, 116, 83, 116, 97, 114, 40, 108, 101, 118, 101, 108, 73, 100, 115, 91, 105, 93, 41, 10, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 114, 101, 116, 117, 114, 110, 32, 115, 116, 97, 114, 10, 101, 110, 100, 10, 10, 45, 45, 232, 142, 183, 229, 190, 151, 228, 184, 187, 233, 162, 152, 229, 133, 179, 229, 141, 161, 229, 174, 140, 230, 136, 144, 230, 149, 176, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 71, 101, 116, 75, 105, 116, 70, 105, 110, 105, 115, 104, 76, 101, 118, 101, 108, 78, 117, 109, 40, 107, 105, 116, 73, 100, 41, 10, 32, 32, 32, 32, 108, 111, 99, 97, 108, 32, 110, 117, 109, 32, 61, 32, 48, 10, 32, 32, 32, 32, 108, 111, 99, 97, 108, 32, 107, 105, 116, 67, 111, 110, 102, 105, 103, 32, 61, 32, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 71, 101, 116, 75, 105, 116, 67, 111, 110, 102, 105, 103, 66, 121, 73, 100, 40, 107, 105, 116, 73, 100, 41, 10, 32, 32, 32, 32, 108, 111, 99, 97, 108, 32, 108, 101, 118, 101, 108, 73, 100, 115, 32, 61, 32, 115, 116, 114, 105, 110, 103, 46, 115, 112, 108, 105, 116, 40, 107, 105, 116, 67, 111, 110, 102, 105, 103, 46, 108, 101, 118, 101, 108, 73, 68, 44, 32, 34, 95, 34, 44, 32, 116, 111, 110, 117, 109, 98, 101, 114, 41, 10, 32, 32, 32, 32, 102, 111, 114, 32, 105, 61, 49, 44, 32, 35, 108, 101, 118, 101, 108, 73, 100, 115, 32, 100, 111, 10, 32, 32, 32, 32, 32, 32, 32, 32, 105, 102, 32, 116, 104, 105, 115, 46, 71, 101, 116, 76, 101, 118, 101, 108, 73, 115, 70, 105, 110, 105, 115, 104, 40, 108, 101, 118, 101, 108, 73, 100, 115, 91, 105, 93, 41, 32, 116, 104, 101, 110, 10, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 110, 117, 109, 32, 61, 32, 110, 117, 109, 32, 43, 32, 49, 10, 32, 32, 32, 32, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 114, 101, 116, 117, 114, 110, 32, 110, 117, 109, 10, 101, 110, 100, 10, 10, 45, 45, 232, 142, 183, 229, 190, 151, 229, 133, 179, 229, 141, 161, 230, 128, 187, 230, 149, 176, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 71, 101, 116, 84, 111, 116, 97, 108, 76, 101, 118, 101, 108, 78, 117, 109, 40, 41, 10, 32, 32, 32, 32, 114, 101, 116, 117, 114, 110, 32, 35, 76, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 95, 67, 111, 110, 102, 105, 103, 46, 95, 107, 101, 121, 115, 10, 101, 110, 100, 10, 10, 45, 45, 232, 142, 183, 229, 190, 151, 230, 152, 159, 230, 152, 159, 230, 128, 187, 48, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 71, 101, 116, 84, 111, 116, 97, 108, 83, 116, 97, 114, 40, 41, 10, 32, 32, 32, 32, 108, 111, 99, 97, 108, 32, 115, 116, 97, 114, 32, 61, 32, 49, 48, 48, 10, 32, 32, 32, 32, 108, 111, 99, 97, 108, 32, 69, 97, 99, 104, 75, 101, 121, 86, 97, 108, 117, 101, 32, 61, 32, 102, 117, 110, 99, 116, 105, 111, 110, 40, 107, 101, 121, 44, 32, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 41, 10, 32, 32, 32, 32, 32, 32, 32, 32, 115, 116, 97, 114, 32, 61, 32, 115, 116, 97, 114, 32, 43, 32, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 58, 71, 101, 116, 66, 101, 115, 116, 83, 116, 97, 114, 40, 41, 10, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 116, 104, 105, 115, 46, 108, 101, 118, 101, 108, 68, 101, 116, 97, 105, 108, 115, 68, 97, 116, 97, 68, 105, 99, 116, 58, 70, 111, 114, 69, 97, 99, 104, 75, 101, 121, 86, 97, 108, 117, 101, 40, 69, 97, 99, 104, 75, 101, 121, 86, 97, 108, 117, 101, 41, 10, 32, 32, 32, 32, 114, 101, 116, 117, 114, 110, 32, 115, 116, 97, 114, 10, 101, 110, 100, 10, 10, 45, 45, 230, 152, 175, 229, 144, 166, 233, 166, 150, 230, 172, 161, 232, 167, 166, 229, 143, 145, 229, 176, 143, 230, 137, 139, 230, 143, 144, 231, 164, 186, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 73, 115, 70, 105, 114, 115, 116, 83, 116, 101, 112, 72, 97, 110, 100, 84, 105, 112, 40, 41, 10, 32, 32, 32, 32, 105, 102, 32, 110, 111, 116, 32, 116, 104, 105, 115, 46, 105, 115, 70, 105, 114, 115, 116, 83, 116, 101, 112, 72, 97, 110, 100, 84, 105, 112, 32, 116, 104, 101, 110, 32, 10, 32, 32, 32, 32, 32, 32, 32, 32, 116, 104, 105, 115, 46, 105, 115, 70, 105, 114, 115, 116, 83, 116, 101, 112, 72, 97, 110, 100, 84, 105, 112, 32, 61, 32, 85, 115, 101, 114, 68, 97, 116, 97, 72, 101, 108, 112, 101, 114, 46, 71, 101, 116, 73, 110, 116, 40, 67, 97, 99, 104, 101, 84, 121, 112, 101, 46, 70, 73, 82, 83, 84, 95, 83, 84, 69, 80, 95, 72, 65, 78, 68, 84, 73, 80, 44, 48, 41, 10, 32, 32, 32, 32, 101, 110, 100, 10, 32, 32, 32, 32, 114, 101, 116, 117, 114, 110, 32, 116, 104, 105, 115, 46, 105, 115, 70, 105, 114, 115, 116, 83, 116, 101, 112, 72, 97, 110, 100, 84, 105, 112, 32, 61, 61, 32, 48, 10, 101, 110, 100, 10, 10, 102, 117, 110, 99, 116, 105, 111, 110, 32, 80, 108, 97, 121, 101, 114, 68, 97, 116, 97, 77, 97, 110, 97, 103, 101, 114, 46, 83, 101, 116, 73, 115, 70, 105, 114, 115, 116, 83, 116, 101, 112, 72, 97, 110, 100, 84, 105, 112, 40, 41, 10, 32, 32, 32, 32, 116, 104, 105, 115, 46, 105, 115, 70, 105, 114, 115, 116, 83, 116, 101, 112, 72, 97, 110, 100, 84, 105, 112, 32, 61, 32, 49, 10, 32, 32, 32, 32, 85, 115, 101, 114, 68, 97, 116, 97, 72, 101, 108, 112, 101, 114, 46, 83, 101, 116, 73, 110, 116, 40, 67, 97, 99, 104, 101, 84, 121, 112, 101, 46, 70, 73, 82, 83, 84, 95, 83, 84, 69, 80, 95, 72, 65, 78, 68, 84, 73, 80, 44, 49, 41, 10, 101, 110, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
var is32 = 0xC;//游戏32位写0xc, 游戏64位写0x10(未测试，如果有错修改下，并告知我);


setImmediate(hook_dlopen);
